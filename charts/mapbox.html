<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>要啥自行车</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0px; bottom:0px; width:100%; }
    </style>
</head>
<body>
  <style>
      #menu {
          background: #fff;
          position: absolute;
          z-index: 1;
          top: 10px;
          right: 10px;
          border-radius: 3px;
          width: 120px;
          border: 1px solid rgba(0, 0, 0, 0.4);
          font-family: 'Open Sans', sans-serif;
      }

      #menu a {
          font-size: 13px;
          color: #000000;
          display: block;
          margin: 0;
          padding: 0;
          padding: 0px;
          text-decoration: none;
          border-bottom: 1px solid rgba(0,0,0,0.25);
          text-align: center;
      }

      #menu a:last-child {
          border: none;
      }

      #menu a:hover {
          background-color: #f8f8f8;
          color: #404040;
      }

      #menu a.active {
          background-color: #000000;
          color: #ffffff;
      }

      #menu a.active:hover {
          background: #000000;
      }
  </style>

  <nav id="menu"></nav>
  <div id="map"></div>


<script>
mapboxgl.accessToken = 'pk.eyJ1IjoieHpyYW5ubm4iLCJhIjoiY2pmaXZxbjIxMGEzaDJ3cThnaTc1a25tNCJ9.Ny6q1ACtjLDEANDbJEIIRw';
var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/xzrannnn/cjfurtym815jv2srs1vb0gqd1', //hosted style id
    center: [-87.6298,41.8781], // starting position，可替换为您自己的地图中心坐标
    zoom: 13.5 // starting zoom，可替换为您自己的地图缩放倍数
});

map.on('load', function () {

  // Insert the layer beneath any symbol layer.
  var layers = map.getStyle().layers;

  var labelLayerId;
  for (var i = 0; i < layers.length; i++) {
      if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
          labelLayerId = layers[i].id;
          break;
      }
  }

  map.addLayer({
      'id': '3d-buildings',
      'source': 'composite',
      'source-layer': 'building',
      'filter': ['==', 'extrude', 'true'],
      'type': 'fill-extrusion',
      'minzoom': 15,
      'paint': {
          'fill-extrusion-color': '#aaa',

          // use an 'interpolate' expression to add a smooth transition effect to the
          // buildings as the user zooms in
          'fill-extrusion-height': [
              "interpolate", ["linear"], ["zoom"],
              15, 0,
              15.05, ["get", "height"]
          ],
          'fill-extrusion-base': [
              "interpolate", ["linear"], ["zoom"],
              15, 0,
              15.05, ["get", "min_height"]
          ],
          'fill-extrusion-opacity': .6
      }
  }, labelLayerId);

/// Long Duration ///
    map.addSource('L_0_6', {
        type: 'vector',
        url: 'mapbox://xzrannnn.cjfunk6re0lgx33qc1am7gj8i-4tr4g'
    });

    map.addSource('L_6_12', {
        type: 'vector',
        url: 'mapbox://xzrannnn.cjfunkopa0f7m2yt8by5kk5q2-9996w'
    });

    map.addSource('L_12_18', {
        type: 'vector',
        url: 'mapbox://xzrannnn.cjfunkvjl0f7p2yt8qhyutcjm-8yguk'
    });

    map.addSource('L_18_24', {
        type: 'vector',
        url: 'mapbox://xzrannnn.cjfunl1f10lha33qcrg9aww19-03hrb'
    });

    map.addLayer({
        'id': '>1h',
        'type': 'line',
        'source': 'L_0_6',
        'source-layer': 'L_0_6',
        'layout': {
            'visibility': 'visible',
            'line-join': 'round',
            'line-cap': 'round'
        },
        'paint': {
            'line-color': '#002cf4',
            "line-opacity": 0.8,
            "line-width": 0.1,
        }
    });

    map.addLayer({
        'id': '>1ha',
        'type': 'line',
        'source': 'L_6_12',
        'source-layer': 'L_6_12',
        'layout': {
            'visibility': 'visible',
            'line-join': 'round',
            'line-cap': 'round'
        },
        'paint': {
            'line-color': '#002cf4',
            "line-opacity": 0.8,
            "line-width": 0.1,
        }
    });

    map.addLayer({
        'id': '>1haa',
        'type': 'line',
        'source': 'L_12_18',
        'source-layer': 'L_12_18',
        'layout': {
            'visibility': 'visible',
            'line-join': 'round',
            'line-cap': 'round'
        },
        'paint': {
            'line-color': '#002cf4',
            "line-opacity": 0.8,
            "line-width": 0.1,
        }
    });

    map.addLayer({
        'id': '>1haaa',
        'type': 'line',
        'source': 'L_18_24',
        'source-layer': 'L_18_24',
        'layout': {
            'visibility': 'visible',
            'line-join': 'round',
            'line-cap': 'round'
        },
        'paint': {
            'line-color': '#002cf4',
            "line-opacity": 0.8,
            "line-width": 0.1,
        }
    });

/// Middle Duration a ///
        map.addSource('M_0_6', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunmffp04ur2rlhe75n9fkp-5azl2'
        });

        map.addSource('M_6_12', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunmlvs0auk2wo8ajqmto3x-99bzz'
        });

        map.addSource('M_12_18', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunmwvf0rf92qqcuhhs6x1p-8ew0b'
        });

        map.addSource('M_18_24', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunnblc0mzu2wmwg83a2wxd-6pb7x'
        });

        map.addLayer({
            'id': '15min~1h',
            'type': 'line',
            'source': 'M_0_6',
            'source-layer': 'M_0_6',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#3082bf',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '15min~1ha',
            'type': 'line',
            'source': 'M_6_12',
            'source-layer': 'M_6_12',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#3082bf',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '15min~1haa',
            'type': 'line',
            'source': 'M_12_18',
            'source-layer': 'M_12_18',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#3082bf',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '15min~1haaa',
            'type': 'line',
            'source': 'M_18_24',
            'source-layer': 'M_18_24',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#3082bf',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

/// Short Duration aa ///
        map.addSource('S_0_6', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunow2w0a5l2qo8hkrnzxlc-2yc8e'
        });

        map.addSource('S_6_12', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfuo60ey0rtl2qmwsyr90qrt-7nrx8'
        });

        map.addSource('S_12_18', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfuojddb0s0b33p90l5ynbns-9duds'
        });

        map.addSource('S_18_24', {
            type: 'vector',
            url: 'mapbox://xzrannnn.cjfunpveg0fvy32nuxysa9mgk-9041u'
        });

        map.addLayer({
            'id': '<15min',
            'type': 'line',
            'source': 'S_0_6',
            'source-layer': 'S_0_6',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#72f696',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '<15mina',
            'type': 'line',
            'source': 'S_6_12',
            'source-layer': 'S_6_12',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#72f696',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '<15minaa',
            'type': 'line',
            'source': 'S_12_18',
            'source-layer': 'S_12_18',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#72f696',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });

        map.addLayer({
            'id': '<15minaaa',
            'type': 'line',
            'source': 'S_18_24',
            'source-layer': 'S_18_24',
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#72f696',
                "line-opacity": 0.8,
                "line-width": 0.1,
            }
        });
});


var toggleableLayerIds = ['>1h','15min~1h','<15min'];

for (var i = 0; i < toggleableLayerIds.length; i++) {
    var id = toggleableLayerIds[i];
    var ida = toggleableLayerIds[i]+'a';
    var idaa = toggleableLayerIds[i]+'aa';
    var idaaa = toggleableLayerIds[i]+'aaa';

    var link = document.createElement('a');
    link.href = '#';
    link.className = 'active';

    link.textContent = id;
    link.textContenta = ida;
    link.textContentaa = idaa;
    link.textContentaaa = idaaa;

    link.onclick = function (e) {
        var clickedLayer = this.textContent;
        var clickedLayera = this.textContenta;
        var clickedLayeraa = this.textContentaa;
        var clickedLayeraaa = this.textContentaaa;

        e.preventDefault();
        e.stopPropagation();

        var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
        var visibilitya = map.getLayoutProperty(clickedLayera, 'visibility');
        var visibilityaa = map.getLayoutProperty(clickedLayeraa, 'visibility');
        var visibilityaaa = map.getLayoutProperty(clickedLayeraaa, 'visibility');

        if (visibility === 'visible') {
            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
        }

        if (visibilitya === 'visible') {
            map.setLayoutProperty(clickedLayera, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayera, 'visibility', 'visible');
        }

        if (visibilityaa === 'visible') {
            map.setLayoutProperty(clickedLayeraa, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayeraa, 'visibility', 'visible');
        }

        if (visibilityaaa === 'visible') {
            map.setLayoutProperty(clickedLayeraaa, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayeraaa, 'visibility', 'visible');
        }
    };

    var layers = document.getElementById('menu');
    layers.appendChild(link);
}

</script>
</body>
</html>
